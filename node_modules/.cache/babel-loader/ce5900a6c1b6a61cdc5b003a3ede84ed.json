{"ast":null,"code":"const findTopValue = (obj, topN) => {\n  let topObj = {};\n  var keys = Object.keys(obj);\n  keys.sort((a, b) => {\n    return obj[a] - obj[b];\n  });\n  keys.slice(-2).reverse().forEach(k => {\n    topObj[k] = obj[k];\n  });\n  let topArr = [];\n\n  for (var key in topObj) {\n    topArr.push(`${key} (${topObj[key]} games)`);\n  }\n\n  return topArr;\n};\n\nconst RetrieveData = async (summonerName, enteredRegion) => {\n  const riotAPIKey = \"RGAPI-8a62b8a3-4e69-40eb-b56d-786ccda80987\"; //Get summoner ID\n\n  const summonerIdResponse = await fetch(`https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/by-name/${summonerName}?api_key=${riotAPIKey}`, {\n    accept: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  let summonerId = (await summonerIdResponse.json())[\"id\"]; //   //Get clash team ID\n  // const teamIdResponse = await fetch(\n  //     `https://${enteredRegion}.api.riotgames.com/lol/clash/v1/players/by-summoner/${summonerId}?api_key=${riotAPIKey}`,\n  //     {\n  //       accept: {\n  //         \"Content-Type\": \"application/json\",\n  //       },\n  //     }\n  //   )\n  //   let teamId = (await teamIdResponse.json())[0][\"teamId\"];\n  //   //Get clash team plays summoner ID\n  //   const teamMembersResponse = await fetch(\n  //     `https://${enteredRegion}.api.riotgames.com/lol/clash/v1/teams/${teamId}?api_key=${riotAPIKey}`,\n  //     {\n  //       accept: {\n  //         \"Content-Type\": \"application/json\",\n  //       },\n  //     }\n  //   )\n  //   let teamMembers = (await teamMembersResponse.json())[\"players\"];\n  // let players = [];\n  //   for (var player of teamMembers) { //probs need to fix this\n  //     let playerSummonerID = player[\"summonerId\"];\n  //       const playerSummonerNameResponse = await fetch(\n  //         `https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/${playerSummonerID}?api_key=${riotAPIKey}`,\n  //         {\n  //           accept: {\n  //             \"Content-Type\": \"application/json\",\n  //           },\n  //         }\n  //       );\n  //       let playerSummonerName = await playerSummonerNameResponse.json();\n  //       let playerData = {\"name\":playerSummonerName['name'], \"position\":player[\"position\"]};\n  //       players.push(playerData);\n  //   }\n  //get opgglink\n\n  let opggURL = `https://oce.op.gg/multi/query=${summonerName.replace(\" \", \"%20\")}`; // for (player of players) {\n  //   let playerFormatted = player['name'].replace(\" \", \"%20\");\n  //   opggURL += playerFormatted + \"%2C\"\n  // }\n  //group information\n  // const playerDict = {\n  //   userData: players,\n  //   opggURL: opggURL\n  // };\n  //   //get puuid for each summoner\n  //   for (var player of players['name']) {\n  //     //get puuid\n  //     //get matches\n  //     //get game info and concat it\n\n  const summonerpuuidResponse = await fetch(`https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/by-name/${summonerName}?api_key=${riotAPIKey}`, {\n    accept: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  let summonerPuuid = (await summonerpuuidResponse.json())[\"puuid\"]; //get match id for player\n\n  const summonerMatchesResponse = await fetch(`https://americas.api.riotgames.com/lol/match/v5/matches/by-puuid/${summonerPuuid}/ids?type=ranked&start=0&count=15&api_key=${riotAPIKey}`, {\n    accept: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n  let summonerMatches = await summonerMatchesResponse.json(); //get match details for player\n\n  let winRate = {\n    WIN: 0,\n    LOSS: 0\n  };\n  let roleCounterObj = {};\n  let championPoolObj = {};\n\n  for (let match of summonerMatches) {\n    const summonerMatchInfoResponse = await fetch(`https://americas.api.riotgames.com/lol/match/v5/matches/${match}?api_key=${riotAPIKey}`, {\n      accept: {\n        \"Content-Type\": \"application/json\"\n      }\n    });\n    let summonerMatchInfo = (await summonerMatchInfoResponse.json())[\"info\"][\"participants\"];\n\n    for (var participant of summonerMatchInfo) {\n      if (participant[\"summonerName\"].toLowerCase() === summonerName.toLowerCase()) {\n        // MOST PLAYED POSITION\n        if (participant[\"individualPosition\"] in roleCounterObj) {\n          roleCounterObj[participant[\"individualPosition\"]] = ++roleCounterObj[participant[\"individualPosition\"]];\n        } else {\n          roleCounterObj[participant[\"individualPosition\"]] = 1;\n        } // WINRATE\n\n\n        if (participant[\"win\"]) {\n          winRate.WIN = ++winRate[\"WIN\"];\n        } else if (!participant[\"win\"]) {\n          winRate.LOSS = ++winRate[\"LOSS\"];\n        } // MOST PLAYED CHAMPIONS \n\n\n        if (participant[\"championName\"] in championPoolObj) {\n          championPoolObj[participant[\"championName\"]] = ++championPoolObj[participant[\"championName\"]];\n        } else {\n          championPoolObj[participant[\"championName\"]] = 1;\n        }\n      }\n    }\n  }\n\n  const playerDict = {\n    userData: [{\n      name: summonerName,\n      position: \"MID\",\n      winRate: parseInt(winRate[\"WIN\"] / (winRate[\"WIN\"] + winRate[\"LOSS\"]) * 100),\n      mainRole: findTopValue(roleCounterObj, 2),\n      topChampions: findTopValue(championPoolObj, 2)\n    }],\n    opggURL: opggURL\n  };\n  return playerDict;\n};\n\n_c = RetrieveData;\nexport default RetrieveData;\n\nvar _c;\n\n$RefreshReg$(_c, \"RetrieveData\");","map":{"version":3,"names":["findTopValue","obj","topN","topObj","keys","Object","sort","a","b","slice","reverse","forEach","k","topArr","key","push","RetrieveData","summonerName","enteredRegion","riotAPIKey","summonerIdResponse","fetch","accept","summonerId","json","opggURL","replace","summonerpuuidResponse","summonerPuuid","summonerMatchesResponse","summonerMatches","winRate","WIN","LOSS","roleCounterObj","championPoolObj","match","summonerMatchInfoResponse","summonerMatchInfo","participant","toLowerCase","playerDict","userData","name","position","parseInt","mainRole","topChampions"],"sources":["C:/Users/Lillyt/Desktop/GIT/Clash-app/src/Components/Search/RetrieveData.js"],"sourcesContent":["const findTopValue = (obj, topN) => {\r\n  let topObj = {}\r\n  var keys = Object.keys(obj);\r\n  keys.sort((a, b) => {\r\n    return obj[a] - obj[b]\r\n  });\r\n\r\n  keys.slice(-2).reverse().forEach((k) => {\r\n    topObj[k] = obj[k];\r\n  })\r\n\r\n  let topArr = []\r\n\r\n  for (var key in topObj) {\r\n    topArr.push(`${key} (${topObj[key]} games)`)\r\n}\r\n\r\n  return topArr;\r\n}\r\n\r\nconst RetrieveData = async (summonerName, enteredRegion) => {\r\n  const riotAPIKey = \"RGAPI-8a62b8a3-4e69-40eb-b56d-786ccda80987\";\r\n\r\n  //Get summoner ID\r\n  const summonerIdResponse = await fetch(\r\n    `https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/by-name/${summonerName}?api_key=${riotAPIKey}`,\r\n    {\r\n      accept: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    }\r\n  );\r\n\r\n  let summonerId = (await summonerIdResponse.json())[\"id\"];\r\n\r\n  //   //Get clash team ID\r\n  // const teamIdResponse = await fetch(\r\n  //     `https://${enteredRegion}.api.riotgames.com/lol/clash/v1/players/by-summoner/${summonerId}?api_key=${riotAPIKey}`,\r\n  //     {\r\n  //       accept: {\r\n  //         \"Content-Type\": \"application/json\",\r\n  //       },\r\n  //     }\r\n  //   )\r\n  //   let teamId = (await teamIdResponse.json())[0][\"teamId\"];\r\n\r\n  //   //Get clash team plays summoner ID\r\n  //   const teamMembersResponse = await fetch(\r\n  //     `https://${enteredRegion}.api.riotgames.com/lol/clash/v1/teams/${teamId}?api_key=${riotAPIKey}`,\r\n  //     {\r\n  //       accept: {\r\n  //         \"Content-Type\": \"application/json\",\r\n  //       },\r\n  //     }\r\n  //   )\r\n\r\n  //   let teamMembers = (await teamMembersResponse.json())[\"players\"];\r\n\r\n  // let players = [];\r\n  //   for (var player of teamMembers) { //probs need to fix this\r\n  //     let playerSummonerID = player[\"summonerId\"];\r\n\r\n  //       const playerSummonerNameResponse = await fetch(\r\n  //         `https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/${playerSummonerID}?api_key=${riotAPIKey}`,\r\n  //         {\r\n  //           accept: {\r\n  //             \"Content-Type\": \"application/json\",\r\n  //           },\r\n  //         }\r\n  //       );\r\n\r\n  //       let playerSummonerName = await playerSummonerNameResponse.json();\r\n  //       let playerData = {\"name\":playerSummonerName['name'], \"position\":player[\"position\"]};\r\n  //       players.push(playerData);\r\n  //   }\r\n\r\n  //get opgglink\r\n  let opggURL = `https://oce.op.gg/multi/query=${summonerName.replace(\r\n    \" \",\r\n    \"%20\"\r\n  )}`;\r\n\r\n  // for (player of players) {\r\n  //   let playerFormatted = player['name'].replace(\" \", \"%20\");\r\n  //   opggURL += playerFormatted + \"%2C\"\r\n  // }\r\n\r\n  //group information\r\n  // const playerDict = {\r\n  //   userData: players,\r\n  //   opggURL: opggURL\r\n  // };\r\n\r\n  //   //get puuid for each summoner\r\n  //   for (var player of players['name']) {\r\n  //     //get puuid\r\n  //     //get matches\r\n  //     //get game info and concat it\r\n\r\n  const summonerpuuidResponse = await fetch(\r\n    `https://${enteredRegion}.api.riotgames.com/lol/summoner/v4/summoners/by-name/${summonerName}?api_key=${riotAPIKey}`,\r\n    {\r\n      accept: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    }\r\n  );\r\n\r\n  let summonerPuuid = (await summonerpuuidResponse.json())[\"puuid\"];\r\n\r\n  //get match id for player\r\n  const summonerMatchesResponse = await fetch(\r\n    `https://americas.api.riotgames.com/lol/match/v5/matches/by-puuid/${summonerPuuid}/ids?type=ranked&start=0&count=15&api_key=${riotAPIKey}`,\r\n    {\r\n      accept: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    }\r\n  );\r\n\r\n  let summonerMatches = await summonerMatchesResponse.json();\r\n\r\n  //get match details for player\r\n  let winRate = { WIN: 0, LOSS: 0 };\r\n  let roleCounterObj = {};\r\n  let championPoolObj = {};\r\n\r\n  for (let match of summonerMatches) {\r\n    const summonerMatchInfoResponse = await fetch(\r\n      `https://americas.api.riotgames.com/lol/match/v5/matches/${match}?api_key=${riotAPIKey}`,\r\n      {\r\n        accept: {\r\n          \"Content-Type\": \"application/json\",\r\n        },\r\n      }\r\n    );\r\n\r\n    let summonerMatchInfo = (await summonerMatchInfoResponse.json())[\"info\"][\"participants\"];\r\n\r\n    for (var participant of summonerMatchInfo) {\r\n      if (participant[\"summonerName\"].toLowerCase() === summonerName.toLowerCase()) {\r\n        // MOST PLAYED POSITION\r\n        if (participant[\"individualPosition\"] in roleCounterObj) {\r\n          roleCounterObj[participant[\"individualPosition\"]] = ++roleCounterObj[participant[\"individualPosition\"]];\r\n        } else {\r\n          roleCounterObj[participant[\"individualPosition\"]] = 1;\r\n        }\r\n        // WINRATE\r\n        if (participant[\"win\"]) {\r\n          winRate.WIN = ++winRate[\"WIN\"];\r\n        } else if (!participant[\"win\"]) {\r\n          winRate.LOSS = ++winRate[\"LOSS\"];\r\n        }\r\n\r\n        // MOST PLAYED CHAMPIONS \r\n        if (participant[\"championName\"] in championPoolObj) {\r\n          championPoolObj[participant[\"championName\"]] = ++championPoolObj[participant[\"championName\"]];\r\n        }\r\n        else {\r\n          championPoolObj[participant[\"championName\"]] = 1\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  const playerDict = {\r\n    userData: [\r\n      {\r\n        name: summonerName,\r\n        position: \"MID\",\r\n        winRate: parseInt((winRate[\"WIN\"] / (winRate[\"WIN\"] + winRate[\"LOSS\"])) * 100),\r\n        mainRole: findTopValue(roleCounterObj, 2),\r\n        topChampions: findTopValue(championPoolObj, 2)\r\n      }, \r\n    ],\r\n\r\n    opggURL: opggURL,\r\n  };\r\n  return playerDict;\r\n};\r\n\r\nexport default RetrieveData;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}